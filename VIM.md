# VIM





## 1. [vim简介](https://zh-wiki.info/wiki/Vim)



* vi：Visual Interface	文本编辑器，vim的前身版本，在很早的Linux上就有vi
  * vim：Vi Improved 	Vi 增强版
  * 装最小化linux系统默认是安装：vi

* 文本：ASCII、Unicode
* 文本编辑种类：
  * 行编辑器：sed
  * 全屏编辑器：nano，vi
  * vim
* 其他编辑器：
  * gedit	一个简单的图形编辑器
  * gvim    一个Vim编辑器的图形版本

补充：

>学习曲线

> 对于大多数用户来说，Vim有着一个比较陡峭的[学习曲线](https://zh-wiki.info/wiki/经验学习曲线)。这意味着开始学习的时候可能会进展缓慢，但是一旦掌握一些基本操作之后，能大幅度提高编辑效率。为了帮助学习，Vim为初学者准备了Vim教学。通常可以在Unix系统命令行下输入"vimtutor"或者点击Windows系统桌面上的Vim教学图标进入。在Vim用户手册中更加详细的描述了Vim的基础和进阶功能。可以在Vim中输入":help user-manual"进入用户手册。手册除了原始的英文版本之外，也被志愿者翻译成了各国文字，其中包括中文。

> 新用户也应该学习Vim的帮助系统。可以在Vim中输入不带参数的"help"来阅读主帮助文件。





## 2. vim：一个模式编辑器



vim是依赖“模式的”

vim主要有三种模式：

​	命令模式：Normal 默认模式，移动光标，剪切/粘贴文本

​	插入模式：Insert 或称编辑模式，用来修改文本

​	扩展模式：extended command，用来保存，退出等

Esc键：退出当前模式

​	总是返回到命令模式。



## 3. 模式转换



| 从命令模式>插入模式： |                                    |
| --------------------- | ---------------------------------- |
| `i`                   | insert,在光标所在处输入            |
| `I`                   | 在当前光标所在行的行首输入         |
| `a`                   | append,在光标所以在处后面输入      |
| `A`                   | 在当前光标所在行的行尾输入         |
| `o`                   | 在当前光标所在行的下方打开一个新行 |
| `O`                   | 在当前光标所在行的上方打开一个新行 |



插入模式 --`ESC`-->命令模式

命令模式--`:`-->拓展命令模式

拓展命令模式--`ESC ，enter`-->命令模式



## 4. 打开文件



#### #vim [OPTION]... FILE...

```bash
+#	打开文件后，让光标处于第#行的行首，+默认行尾
	
    vim +10 /etc/passwd
    
    vim可以判断文件是否为系统配置文件，并配色
   
+/PATTERN 让光标处于第一个被PATTERN匹配到的行的行首

-b FILE 二进制方式打开文件

-d FILE1 FILE2... 比较多个文件

-m FILE 只读打开文件

-e FILE 或者 ex FILE 直接进入ex模式

如果该文件存在，文件被打开并显示内容，如果该文件不存在，当编辑后第一次存盘时创建他。
```



## 5.关闭文件



#### 我们可以在普通模式下和扩展命令模式下退出：

``` bash
扩展命令模式：
	:q		退出
	:q!		强制退出，丢弃作出的修改
	:wq		保存退出
	:x		保存退出
	
命令模式：
	ZZ		保存退出
	ZQ		不保存退出
```



## 6. 扩展命令模式



#### 按 `:` 进入扩展命令模式

​	创建一个命令提示符，位置在屏幕底部的左侧



| 常见命令：   |                                                    |
| ------------ | -------------------------------------------------- |
| `w`          | 写(存)磁盘文件                                     |
| `wq`         | 写入并退出                                         |
| `x`          | 写入并退出，上面有说                               |
| `q`          | 退出                                               |
| `q!`         | 不存盘退出                                         |
| `r FileName` | 读取文件内容到当前文件中                           |
| `w FileName` | 将当前文件内容写到另一个文件，另存为               |
| `!COMMAND`   | 执行命令，Vim在不退出的情况下可以执行命令！        |
| `r!COMMAND`  | 读入命令的输出，将当前命令的执行结果放入当前文件中 |



## 7. 命令模式



| 7.1 字符间跳转： |                       |
| ---------------- | --------------------- |
| `h`              | 左                    |
| `i`              | 右                    |
| `j`              | 上                    |
| `k`              | 下                    |
| `#COMMAND`       | 跳转由#指定个数的字符 |



| 7.2 单词间跳转： |                         |
| ---------------- | ----------------------- |
| `w`              | 下一个单词的词首        |
| `e`              | 当前或下一个单词的词尾  |
| `b`              | 当前或前一个单词的词首  |
| `#COMMAND`       | 由#指定一次跳转的单词数 |
|                  |                         |

| 7.3 当前页跳转： |                              |
| ---------------- | ---------------------------- |
| `H`              | 页首                         |
| `M`              | 页中间行                     |
| `L`              | 页底                         |
| `zt`             | 将光标所在当前行移到屏幕顶端 |
| `zz`             | 将光标所在当前行移到屏幕中间 |
| `zb`             | 将光标所在当前行移到屏幕底端 |
|                  |                              |

| 7.4 行首行尾跳转： |                              |
| ------------------ | ---------------------------- |
| `^`                | 跳转至行首的第一个非空白字符 |
| `0`                | 跳转至行首                   |
| `$`                | 跳转至行尾                   |
|                    |                              |

| 7.5 行间移动：       |             |
| -------------------- | ----------- |
| `#G` 或扩展命令下的# | 跳转至第#行 |
| `G`                  | 最后一行    |
| `1G`或者`gg`         | 第一行      |
|                      |             |

| 7.6 句间移动：("."隔开算句子) |        |
| ----------------------------- | ------ |
| `)`                           | 下一句 |
| `(`                           | 上一句 |



| 7.7 段落间移动： |        |
| ---------------- | ------ |
| `}`              | 下一段 |
| ` {`             | 上一段 |



| 7.8 翻屏操作： |                  |
| -------------- | ---------------- |
| `Ctrl+f`       | 向文件尾部翻一屏 |
| `Ctrl+b`       | 向文件首部翻一屏 |
| `Ctrl+d`       | 向文件尾部翻半屏 |
| `Ctrl+u`       | 向文件首部翻半屏 |



| 7.9 字符编辑： |                                        |
| -------------- | -------------------------------------- |
| `x`            | 删除光标处的字符                       |
| `#x`           | 删除光标处起始的#个字符                |
| `xp`           | 交换光标所在处的字符及其后面字符的位置 |
| `~`            | 转换大小写                             |
| `J`            | 删除当前行后的换行符                   |
|                |                                        |

| 7.10 替换命令(r，replace) |                    |
| ------------------------- | ------------------ |
| `r`                       | 替换光标所在处字符 |
| `R`                       | 切换成REPLACE模式  |
|                           |                    |

  

| 7.11 删除命令： |                                            |
| --------------- | ------------------------------------------ |
| `d`             | 删除命令，可结合光标跳转字符，实现范围删除 |
| `d$`            | 删除到行尾                                 |
| `d^`            | 删除到非空行首                             |
| `d0`            | 删除到行首                                 |
| `dd`            | 删除光标所在行                             |
| `#dd`           | 删除多行                                   |
| `D`             | 从当前光标位置一直删除到行尾，等同于`d$`   |
| `dgg`           | 从当前位置一直删除到行首                   |



| 7.12 复制命令（y，yank） |                   |
| ------------------------ | ----------------- |
| `y`                      | 复制，行为类似于d |
| `yy`                     | 复制行            |
| `#yy`                    | 复制多行          |
| `Y`                      | 复制整行          |
|                          |                   |

| 7.13 改变命令(c，change) |      |
| ------------------------ | ---- |
| `c:`                     |      |
| `c$`                     |      |
| `c^`                     |      |
| `c0`                     |      |
| `cb`                     |      |
| `ce`                     |      |
| `cw`                     |      |
| `cc`                     |      |
| `#cc`                    |      |
| `C`                      |      |
|                          |      |
|                          |      |
|                          |      |

| 7.14 查找  |                                |
| ---------- | ------------------------------ |
| `/PATTERN` | 从当前光标所在处向文件尾部查找 |
| `?PATTERN` | 从当前光标所在处向文件首部查找 |
| `n`        | 与命令同方向                   |
| `N`        | 与命令反方向                   |



| 7.15 撤销更改 |                                  |
| ------------- | -------------------------------- |
| `u`           | 撤销最近的                       |
| `#u`          | 撤销之前多次更改                 |
| `U`           | 撤销光标落在这行后所有此行的更改 |
| `Ctrl+r`      | 重做最后的"撤销"更改             |
| `.`           | 重复前一个操作                   |
| `#.`          | 重复前一个操作#次                |
|               |                                  |



| 其他常用快捷键：    |                                       |
| ------------------- | ------------------------------------- |
| `di"`               | 删除光标所在双引号""内的内容          |
| `yi(`               | 复制光标所在()里的内容                |
| `vi[`               | 选中光标所在[]里的内容                |
| `dtx`               | 删除字符直到遇见光标之后的第一个x字符 |
| `ytx`               | 复制字符直到遇见光标之后的第一个x字符 |
| `start_pos,end_pos` | 地址界定                              |
| `.`                 | 当前行                                |
| `$`                 | 最后一行                              |
| `%`                 | 全文，相当于`1,$`                     |





##### vim的寄存器(剪贴板)

vim有26个命名寄存器和1个无命名寄存器，常存放不同剪贴板内容，可以不同会话间共享。

寄存器名称a-z	格式：`"寄存器` 放在数字和命令之间

​	如：`3"tyy`	表示复制3行到t寄存器中

​			`"tp` 	表示将t寄存器内容粘贴

未指定，将使用无命名寄存器

有10个数字寄存器，用0-9表示，0存放最近复制内容，1存放最近删除内容，当新的文本变更和删除时，1转存到2,2转存到3，以此类推。数字寄存器不能再不同会话之间共享。



##### 标记和宏(macro)

`ma`	将当前位置标记为a，26个字母均可做标记，如：mb，mc等等

`'a`	跳转到a标记的位置，实用的文档内标记方法，文档中跳跃编辑时很有用

`qa`	录制宏a，a为宏名称

`q` 	 停止录制宏

`@a`	 执行宏a

`@@` 	重新执行上次执行的宏



##### 查找并替换

在扩展命令模式下完成查找替换操作：

​	格式：s/要查找的内容/替换的内容/修饰符

​	要查找的内容：可以使用模式

​	替换为的内容：不能使用模式，但可以使用\1，\2，...等后向引用符号；还可以使用“&”引用前面查找是查找到的整个内容

​	修饰符：

​	`i`		忽略大小写

​	`g`		全局替换，默认情况下，每一行只替换第一次出现的内容

​	`gc`		全局替换，每次替换前询问

查找替换中的分隔符/可替换为其它字符

如：

​	`s@要查找的内容@要替换的内容@修饰符`

​	`s#要查找的内容#要替换的内容#修饰符`

